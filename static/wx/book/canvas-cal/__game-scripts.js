window.UIMODE=0,window.CAR_ID=0,window.CAR_COLOR_ID=0,window.CAR_INNER_ID=0,window.CAR_INNER_POS=0,window.CLEAR_PREVENT=!0;var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)}))},TouchInput.prototype.getPinchDistance=function(t,i){var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInput.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInput.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInput.fromWorldPoint=new pc.Vec3,TouchInput.toWorldPoint=new pc.Vec3,TouchInput.worldDiff=new pc.Vec3,TouchInput.prototype.pan=function(t){var i=TouchInput.fromWorldPoint,o=TouchInput.toWorldPoint,n=TouchInput.worldDiff,h=this.entity.camera,c=this.orbitCamera.distance;h.screenToWorld(t.x,t.y,c,i),h.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,c,o),n.sub2(o,i),this.orbitCamera.pivotPoint.add(n)},TouchInput.pinchMidPoint=new pc.Vec2,TouchInput.prototype.onTouchMove=function(t){var i=TouchInput.pinchMidPoint,o=t.touches;if(1==o.length){var n=o[0];this.orbitCamera.pitch-=(n.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(n.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(n.x,n.y)}else if(2==o.length){var h=this.getPinchDistance(o[0],o[1]),c=h-this.lastPinchDistance;this.lastPinchDistance=h,this.orbitCamera.distance-=c*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(o[0],o[1],i),this.lastPinchMidPoint.copy(i)}};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),OrbitCamera.attributes.add("d2_1",{type:"entity",title:"2dscale-1",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("d2_2",{type:"entity",title:"2dscale-2",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("d2_3",{type:"entity",title:"2dscale-3",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("d3_1",{type:"entity",title:"3dscale-1",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("d3_2",{type:"entity",title:"3dscale-2",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("d3_3",{type:"entity",title:"3dscale-3",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("d3_4",{type:"entity",title:"3dscale-4",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("d3_5",{type:"entity",title:"3dscale-5",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var e=(this._targetYaw-this._yaw)%360;this._targetYaw=e>180?this._yaw-(360-e):e<-180?this._yaw+(360+e):this._yaw+e}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){var e=this._modelsAabb.halfExtents,i=Math.max(e.x,Math.max(e.y,e.z));i/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),i*=2,this.distance=i,this._removeInertia()},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,e){this.pivotPoint.copy(e),this.entity.setPosition(t),this.entity.lookAt(e);var i=OrbitCamera.distanceBetween;i.sub2(e,t),this.distance=i.length(),this.pivotPoint.copy(e);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,e){},OrbitCamera.prototype.reset=function(t,e,i){this.pitch=e,this.yaw=t,this.distance=i,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,e=function(){t._checkAspectRatio()};window.addEventListener("resize",e,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var i=this.entity.getRotation();if(this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var a=new pc.Vec3;a.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(a.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",function(t,e){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:distanceMax",function(t,e){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:pitchAngleMin",function(t,e){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:pitchAngleMax",function(t,e){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:focusEntity",function(t,e){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)}),this.on("attr:frameOnStart",function(t,e){t&&this.focus(this.focusEntity||this.app.root)}),this.on("destroy",function(){window.removeEventListener("resize",e,!1)}),this.app.touch?(window.D2_UI_SIZE=1.3,this.d3_1.localScale=new pc.Vec3(2,2,2),this.d3_2.localScale=new pc.Vec3(2,2,2),this.d3_3.localScale=new pc.Vec3(2,2,2),this.d3_4.localScale=new pc.Vec3(2,2,2),this.d3_5.localScale=new pc.Vec3(2,2,2)):window.D2_UI_SIZE=.7},OrbitCamera.prototype.D2_UI_SIZE=.9,OrbitCamera.prototype.update=function(t){window.D2_UI_SIZE!=this.D2_UI_SIZE&&(this.d2_1.localScale=new pc.Vec3(window.D2_UI_SIZE,window.D2_UI_SIZE,window.D2_UI_SIZE),this.d2_2.localScale=new pc.Vec3(window.D2_UI_SIZE,window.D2_UI_SIZE,window.D2_UI_SIZE),this.d2_3.localScale=new pc.Vec3(window.D2_UI_SIZE,window.D2_UI_SIZE,window.D2_UI_SIZE),this.D2_UI_SIZE=window.D2_UI_SIZE);var e=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,e),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,e),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,e),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,e=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>e},OrbitCamera.prototype._buildAabb=function(t,e){var i=0;if(t.model){var a=t.model.meshInstances;for(i=0;i<a.length;i++)0===e?this._modelsAabb.copy(a[i].aabb):this._modelsAabb.add(a[i].aabb),e+=1}for(i=0;i<t.children.length;++i)e+=this._buildAabb(t.children[i],e);return e},OrbitCamera.prototype._calcYaw=function(t){var e=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,e),Math.atan2(-e.x,-e.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,e){var i=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-e,0),i.mul2(a,t);var n=new pc.Vec3;return i.transformVector(pc.Vec3.FORWARD,n),Math.atan2(n.y,-n.z)*pc.math.RAD_TO_DEG};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,o=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",o,!1),this.on("destroy",function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",o,!1)}),this.timeAutoRotate=!0,this.setTimeAuto=!1}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,e=MouseInput.toWorldPoint,i=MouseInput.worldDiff,s=this.entity.camera,n=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,n,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,e),i.sub2(e,o),this.orbitCamera.pivotPoint.add(i)},MouseInput.prototype.update=function(t){this.timeAutoRotate&&(this.orbitCamera.yaw+=.1)},MouseInput.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}clearTimeout(this.setTimeAuto),this.timeAutoRotate=!1},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}var o=this;this.setTimeAuto=setTimeout(function(){o.timeAutoRotate=!0},5e3)},MouseInput.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInput.prototype.onMouseWheel=function(t){window.CLEAR_PREVENT&&(this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault())},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera},KeyboardInput.prototype.postInitialize=function(){this.orbitCamera},KeyboardInput.prototype.update=function(t){this.orbitCamera&&this.app.keyboard.wasPressed(pc.KEY_SPACE)&&(window.UIMODE++,window.UIMODE>=3&&(window.UIMODE=0))};var CarOutsideColorController=pc.createScript("carOutsideColorController");CarOutsideColorController.attributes.add("multiple",{type:"number",default:2,title:"速度因子"}),CarOutsideColorController.attributes.add("material",{type:"asset",assetType:"material",title:"车漆材质"}),CarOutsideColorController.attributes.add("colors",{type:"vec3",array:!0,title:"车体颜色"}),CarOutsideColorController.prototype.initialize=function(){this.colorR=this.colors[window.CAR_COLOR_ID].x/256,this.colorG=this.colors[window.CAR_COLOR_ID].y/256,this.colorB=this.colors[window.CAR_COLOR_ID].z/256},CarOutsideColorController.prototype.update=function(t){var o=window.CAR_COLOR_ID;o>=this.colors.length&&(o=this.colors.length-1),o<0&&(o=0);var r=this.colors[o],l=pc.math.lerp(this.colorR,r.x/256,t*this.multiple),i=pc.math.lerp(this.colorG,r.y/256,t*this.multiple),e=pc.math.lerp(this.colorB,r.z/256,t*this.multiple);l==this.colorR&&i==this.colorG&&e==this.colorB||(this.colorR=l,this.colorG=i,this.colorB=e,this.material.resource.diffuse=new pc.Color(l,i,e),this.material.resource.update())};var CameraController=pc.createScript("cameraController");CameraController.attributes.add("focusTarget",{type:"entity",title:"焦点目标",description:"相机要聚焦的目标"}),CameraController.attributes.add("speed",{type:"number",default:0,title:"speed",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),CameraController.attributes.add("distance",{type:"number",default:5,precision:2,description:"Controls the movement speed"}),CameraController.attributes.add("distanceMin",{type:"number",default:1,min:0,precision:2,description:"Controls the movement speed"}),CameraController.attributes.add("distanceMax",{type:"number",default:20,min:0,precision:2,description:"Controls the movement speed"}),CameraController.attributes.add("xRotation",{type:"number",default:-90,precision:2,description:"Controls the movement speed"}),CameraController.attributes.add("xRotationMin",{type:"number",default:-90,precision:2,description:"Controls the movement speed"}),CameraController.attributes.add("xRotationMax",{type:"number",default:0,precision:2,description:"Controls the movement speed"}),CameraController.attributes.add("yRotation",{type:"number",default:0,precision:2,description:"Controls the movement speed"}),CameraController.attributes.add("yRotationMin",{type:"number",default:0,precision:2,description:"Controls the movement speed"}),CameraController.attributes.add("yRotationMax",{type:"number",default:360,precision:2,description:"Controls the movement speed"}),CameraController.prototype.initialize=function(){this.quat=new pc.Quat,this.distance=pc.math.clamp(this.distance,this.distanceMin,this.distanceMax),this.distanceTarget=this.distance,this.xRotation=pc.math.clamp(this.xRotation,this.xRotationMin,this.xRotationMax),this.xRotationTarget=this.xRotation,this.yRotation=pc.math.clamp(this.yRotation,this.yRotationMin,this.yRotationMax),this.yRotationTarget=this.yRotation},CameraController.prototype.update=function(t){var e=0===this.speed?1:Math.min(t/this.speed,1);this.distance=pc.math.lerp(this.distance,this.distanceTarget,e),this.xRotation=pc.math.lerp(this.xRotation,this.xRotationTarget,e),this.yRotation=pc.math.lerp(this.yRotation,this.yRotationTarget,e);var i=this.xRotation%360,o=this.yRotation%360;this.quat.setFromEulerAngles(i,o,0);var a=this.quat.transformVector(pc.Vec3.BACK).scale(this.distance).add(this.focusTarget.getPosition()),n=this.quat;this.entity.setPosition(a),this.entity.setRotation(n)},CameraController.prototype.getXRotationTarget=function(t){return this.xRotationTarget},CameraController.prototype.setXRotationTarget=function(t){this.xRotationTarget=t,this.xRotationTarget=pc.math.clamp(this.xRotationTarget,this.xRotationMin,this.xRotationMax)},CameraController.prototype.getYRotationTarget=function(t){return this.yRotationTarget},CameraController.prototype.setYRotationTarget=function(t){this.yRotationTarget=t},CameraController.prototype.getDistanceTarget=function(t){return this.distanceTarget},CameraController.prototype.setDistanceTarget=function(t){this.distanceTarget=t,this.distanceTarget=pc.math.clamp(this.distanceTarget,this.distanceMin,this.distanceMax)};var CameraMouseInput=pc.createScript("cameraMouseInput");CameraMouseInput.attributes.add("invertX",{type:"boolean",default:!0,description:"Controls the movement speed"}),CameraMouseInput.attributes.add("invertY",{type:"boolean",default:!0,description:"Controls the movement speed"}),CameraMouseInput.attributes.add("invertZ",{type:"boolean",default:!0,description:"Controls the movement speed"}),CameraMouseInput.attributes.add("sensitivityX",{type:"number",default:1,min:0,precision:2,description:"Controls the movement speed"}),CameraMouseInput.attributes.add("sensitivityY",{type:"number",default:1,min:0,precision:2,description:"Controls the movement speed"}),CameraMouseInput.attributes.add("sensitivityZ",{type:"number",default:1,min:0,precision:2,description:"Controls the movement speed"}),CameraMouseInput.prototype.initialize=function(){this.cameraController=this.entity.script.cameraController,this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.OnMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)},CameraMouseInput.prototype.update=function(e){},CameraMouseInput.prototype.onMouseDown=function(e){this.pressed=!0,e.event.preventDefault()},CameraMouseInput.prototype.OnMouseMove=function(e){if(this.pressed){var t=this.invertX?1:-1,o=this.invertY?1:-1;this.cameraController.setXRotationTarget(this.cameraController.getXRotationTarget()-e.dy*this.sensitivityY*o),this.cameraController.setYRotationTarget(this.cameraController.getYRotationTarget()-e.dx*this.sensitivityX*t)}},CameraMouseInput.prototype.onMouseUp=function(e){this.pressed=!1},CameraMouseInput.prototype.onMouseWheel=function(e){var t=this.invertZ?1:-1;this.cameraController.setDistanceTarget(this.cameraController.getDistanceTarget()-e.wheel*this.sensitivityZ*t)};var MaterialClick=pc.createScript("materialClick");MaterialClick.attributes.add("colorID",{type:"number",default:0}),MaterialClick.attributes.add("tdCurve",{type:"curve"}),MaterialClick.prototype.initialize=function(){this.entity.button.on("click",this.onClick,this)},MaterialClick.prototype.onClick=function(t,i,a){window.bodyColor=this.colorID};var DoorController=pc.createScript("doorController");DoorController.attributes.add("door",{type:"entity",title:"动画目标",description:""}),DoorController.attributes.add("angle",{type:"vec3",title:"开启角度"}),DoorController.attributes.add("multi",{type:"number",default:4,title:"速度系数"}),DoorController.prototype.initialize=function(){this.normalEuler=this.door.getLocalEulerAngles().clone(),this.targetEuler=this.door.getLocalEulerAngles().clone(),this.opened=!1,this.entity.button.on("click",this.onClick,this),this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mouseleave",this.onLeave,this)},DoorController.prototype.update=function(t){if(null!==this.door){var e=this.door.getLocalEulerAngles(),o=pc.math.lerp(e.x,this.targetEuler.x,t*this.multi),r=pc.math.lerp(e.y,this.targetEuler.y,t*this.multi),l=pc.math.lerp(e.z,this.targetEuler.z,t*this.multi);this.door.setLocalEulerAngles(o,r,l)}},DoorController.prototype.onClick=function(t){this.targetEuler=this.opened?this.normalEuler:this.angle,this.opened=!this.opened},DoorController.prototype.onEnter=function(t){document.body.style.cursor="pointer"},DoorController.prototype.onLeave=function(t){document.body.style.cursor="default"};var CameraTouchInput=pc.createScript("cameraTouchInput");CameraTouchInput.attributes.add("invertX",{type:"boolean",default:!0,description:"Controls the movement speed"}),CameraTouchInput.attributes.add("invertY",{type:"boolean",default:!0,description:"Controls the movement speed"}),CameraTouchInput.attributes.add("invertZ",{type:"boolean",default:!0,description:"Controls the movement speed"}),CameraTouchInput.attributes.add("sensitivityX",{type:"number",default:1,min:0,precision:2,description:"Controls the movement speed"}),CameraTouchInput.attributes.add("sensitivityY",{type:"number",default:1,min:0,precision:2,description:"Controls the movement speed"}),CameraTouchInput.attributes.add("sensitivityZ",{type:"number",default:1,min:0,precision:2,description:"Controls the movement speed"}),CameraTouchInput.prototype.initialize=function(){this.cameraController=this.entity.script.cameraController,this.lastTouchPoint=new pc.Vec2,this.lastPinchDistance=0,this.cameraController&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)}))},CameraTouchInput.prototype.update=function(t){},CameraTouchInput.prototype.onTouchStartEndCancel=function(t){var e=t.touches;1==e.length?this.lastTouchPoint.set(e[0].x,e[0].y):2==e.length&&(this.lastPinchDistance=this.getPinchDistance(e[0],e[1]))},CameraTouchInput.prototype.onTouchMove=function(t){var e=t.touches;if(1==e.length){var o=e[0],i=o.y-this.lastTouchPoint.y,n=o.x-this.lastTouchPoint.x,a=this.invertX?1:-1,s=this.invertY?1:-1;this.cameraController.setXRotationTarget(this.cameraController.getXRotationTarget()-i*this.sensitivityY*s),this.cameraController.setYRotationTarget(this.cameraController.getYRotationTarget()-n*this.sensitivityX*a),this.lastTouchPoint.set(o.x,o.y)}else if(2==e.length){var h=this.getPinchDistance(e[0],e[1]),c=h-this.lastPinchDistance;this.lastPinchDistance=h;var r=this.invertZ?1:-1;this.cameraController.setDistanceTarget(this.cameraController.getDistanceTarget()-c*this.sensitivityZ*r)}},CameraTouchInput.prototype.getPinchDistance=function(t,e){var o=t.x-e.x,i=t.y-e.y;return Math.sqrt(o*o+i*i)},CameraTouchInput.prototype.calcMidPoint=function(t,e,o){o.set(e.x-t.x,e.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y};var AnimToggle=pc.createScript("animToggle");AnimToggle.attributes.add("uiMode",{type:"number",default:0}),AnimToggle.attributes.add("openCurve",{type:"curve"}),AnimToggle.attributes.add("closeCurve",{type:"curve"}),window.uiMode=1,AnimToggle.prototype.initialize=function(){this.uiMode=0,this.time=0,this.beginY=this.entity.getLocalPosition().y},AnimToggle.prototype.update=function(i){this.uiMode!=window.uiMode&&(this.uiMode=window.uiMode,1===this.uiMode?this.time=0:0===this.uiMode&&(this.time=0)),this.time+=i;this.entity.getLocalPosition();this.uiMode,console.log(this.entity.getLocalPosition()),this.app.keyboard.wasPressed(pc.KEY_SPACE)&&(window.uiMode=1==window.uiMode?0:1)};var ColorButton=pc.createScript("colorButton");ColorButton.attributes.add("colorID",{type:"number",default:1,title:"颜色ID"}),ColorButton.attributes.add("animMulti",{type:"number",default:0,title:"动画插值"}),ColorButton.attributes.add("normalSize",{type:"vec2",title:"默认大小"}),ColorButton.attributes.add("selectedSize",{type:"vec2",title:"选中大小"}),ColorButton.prototype.initialize=function(){this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this),this.entity.button.on("click",this.onClick,this),this.hover=!1},ColorButton.prototype.update=function(t){this.startedTime+=t;var e=window.CAR_COLOR_ID===this.colorID,o=e||this.hover?this.selectedSize.x:this.normalSize.x,i=e||this.hover?this.selectedSize.y:this.normalSize.y;this.entity.element.width=pc.math.lerp(this.entity.element.width,o,t*this.animMulti),this.entity.element.height=pc.math.lerp(this.entity.element.height,i,t*this.animMulti)},ColorButton.prototype.onEnter=function(t){this.hover=!0,document.body.style.cursor="pointer"},ColorButton.prototype.onLeave=function(t){this.hover=!1,document.body.style.cursor="default"},ColorButton.prototype.onPress=function(t){this.hover=!0},ColorButton.prototype.onRelease=function(t){this.hover=!1},ColorButton.prototype.onClick=function(t,e,o){window.CAR_COLOR_ID=this.colorID};var CarTypeButton=pc.createScript("carTypeButton");CarTypeButton.attributes.add("carID",{type:"number",default:0}),CarTypeButton.attributes.add("activeAsset",{type:"asset",assetType:"texture"}),CarTypeButton.prototype.initialize=function(){this.originalTexture=this.entity.element.textureAsset,this.entity.button.on("click",this.onClick,this),this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mouseleave",this.onLeave,this)},CarTypeButton.prototype.update=function(t){this.entity.element.textureAsset=window.CAR_ID==this.carID?this.activeAsset:this.originalTexture},CarTypeButton.prototype.onClick=function(t,e,n){window.CAR_ID=this.carID},CarTypeButton.prototype.onEnter=function(t){document.body.style.cursor="pointer"},CarTypeButton.prototype.onLeave=function(t){document.body.style.cursor="default"};var PanelController=pc.createScript("panelController");PanelController.attributes.add("uimode",{type:"number",default:0}),PanelController.attributes.add("openDuration",{type:"number",min:.1}),PanelController.attributes.add("openCurve",{type:"curve"}),PanelController.attributes.add("closeDuration",{type:"number"}),PanelController.attributes.add("closeCurve",{type:"curve"}),PanelController.prototype.initialize=function(){window.UIMODE==this.uimode?(this.opened=!0,this.changeTime=this.openDuration):(this.opened=!1,this.changeTime=this.closeDuration)},PanelController.prototype.update=function(e){var t=window.UIMODE==this.uimode;if(t!=this.opened)this.opened=t,this.changeTime=0;else{this.changeTime+=e;var i=this.entity.getLocalPosition();this.opened?(this.changeTime>=this.openDuration&&(this.changeTime=this.openDuration),this.entity.setLocalPosition(i.x,this.openCurve.value(this.changeTime/this.openDuration),i.z)):(this.changeTime>=this.closeDuration&&(this.changeTime=this.closeDuration),this.entity.setLocalPosition(i.x,this.closeCurve.value(this.changeTime/this.closeDuration),i.z))}};var CarInnerButton=pc.createScript("carInnerButton");CarInnerButton.attributes.add("colorID",{type:"number",default:0,title:"内饰ID"}),CarInnerButton.attributes.add("animMulti",{type:"number",default:10,title:"动画插值"}),CarInnerButton.attributes.add("normalSize",{type:"vec2",title:"默认大小"}),CarInnerButton.attributes.add("selectedSize",{type:"vec2",title:"选中大小"}),CarInnerButton.prototype.initialize=function(){this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this),this.entity.button.on("click",this.onClick,this),this.hover=!1},CarInnerButton.prototype.update=function(t){var e=window.CAR_INNER_ID===this.colorID,n=e||this.hover?this.selectedSize.x:this.normalSize.x,i=e||this.hover?this.selectedSize.y:this.normalSize.y;this.entity.element.width=pc.math.lerp(this.entity.element.width,n,t*this.animMulti),this.entity.element.height=pc.math.lerp(this.entity.element.height,i,t*this.animMulti)},CarInnerButton.prototype.onEnter=function(t){this.hover=!0,document.body.style.cursor="pointer"},CarInnerButton.prototype.onLeave=function(t){this.hover=!1,document.body.style.cursor="default"},CarInnerButton.prototype.onPress=function(t){this.hover=!0},CarInnerButton.prototype.onRelease=function(t){this.hover=!1},CarInnerButton.prototype.onClick=function(t,e,n){window.CAR_INNER_ID=this.colorID};var InnerCamera=pc.createScript("innerCamera");InnerCamera.attributes.add("mouseOrbitSensitivity",{type:"number",default:1,title:"mouseOrbitSensitivity"}),InnerCamera.attributes.add("touchOrbitSensitivity",{type:"number",default:1,title:"touchOrbitSensitivity"}),InnerCamera.attributes.add("angleLockMin",{type:"number",default:-90,precision:2,title:"angleLockMin"}),InnerCamera.attributes.add("angleLockMax",{type:"number",default:90,precision:2,title:"angleLockMax"}),InnerCamera.attributes.add("fov",{type:"number",default:80,precision:0,title:"fov"}),InnerCamera.attributes.add("defaultPitch",{type:"number",default:90,title:"Default Pitch"}),InnerCamera.attributes.add("defaultYaw",{type:"number",default:-30,title:"Default Yaw"}),InnerCamera.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera&&(this.cameraDistanceMax=this.orbitCamera.distanceMax,this.cameraDistanceMin=this.orbitCamera.distanceMin,this.cameraPitchAngleMax=this.orbitCamera.pitchAngleMax,this.cameraPitchAngleMin=this.orbitCamera.pitchAngleMin,this.cameraInertiaFactor=this.orbitCamera.inertiaFactor,this.cameraFov=this.entity.camera.fov,this.cameraMouseOrbitSensitivity=this.entity.script.mouseInput.orbitSensitivity,this.cameraTouchOrbitSensitivity=this.entity.script.touchInput.orbitSensitivity,this.uimode=0,this.innerID=-1,this.posID=-1),this.opacity1=1,this.opacity2=1,this.current=1},InnerCamera.prototype.update=function(t){window.UIMODE!=this.uimode&&(this.uimode=window.UIMODE,2==this.uimode?(this.orbitCamera.distanceMin=0,this.orbitCamera.distanceMax=0,this.orbitCamera.distance=0,this.orbitCamera.pitchAngleMin=this.angleLockMin,this.orbitCamera.pitchAngleMax=this.angleLockMax,this.entity.camera.fov=this.fov,this.entity.script.mouseInput.orbitSensitivity=this.mouseOrbitSensitivity,this.entity.script.touchInput.orbitSensitivity=this.touchOrbitSensitivity,this.orbitCamera.reset(this.defaultPitch,this.defaultYaw,0)):(this.orbitCamera.distanceMax=this.cameraDistanceMax,this.orbitCamera.distanceMin=this.cameraDistanceMin,this.orbitCamera.pitchAngleMax=this.cameraPitchAngleMax,this.orbitCamera.pitchAngleMin=this.cameraPitchAngleMin,this.orbitCamera.inertiaFactor=this.cameraInertiaFactor,this.entity.camera.fov=this.cameraFov,this.entity.script.mouseInput.orbitSensitivity=this.cameraMouseOrbitSensitivity,this.entity.script.touchInput.orbitSensitivity=this.cameraTouchOrbitSensitivity))};var WindowController=pc.createScript("windowController");WindowController.attributes.add("window",{type:"entity",title:"动画目标",description:""}),WindowController.attributes.add("meshName",{type:"string",title:"网格名字",description:""}),WindowController.attributes.add("openAnimName",{type:"string",title:"打开动画名",description:""}),WindowController.attributes.add("closeAnimName",{type:"string",title:"关闭动画名",description:""}),WindowController.prototype.initialize=function(){this.entity.button.on("click",this.onClick,this),this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mouseleave",this.onLeave,this),this.openStep=0,this.windowMesh=this.window.findByPath("RootNode/"+this.meshName),this.windowPosition=this.windowMesh.getPosition().clone(),this.pointPosition=this.entity.getPosition().clone()},WindowController.prototype.update=function(t){},WindowController.prototype.onClick=function(t){this.window.animation.playing||(0===this.openStep?(this.openStep=1,this.window.animation.play(this.openAnimName)):1==this.openStep&&(this.openStep=0,this.window.animation.play(this.closeAnimName)))},WindowController.prototype.onEnter=function(t){document.body.style.cursor="pointer"},WindowController.prototype.onLeave=function(t){document.body.style.cursor="default"};var HotPointAnim=pc.createScript("hotPointAnim");HotPointAnim.attributes.add("duration",{type:"number",min:.1,default:1,title:"动画时长"}),HotPointAnim.attributes.add("scaleCurve",{type:"curve",title:"缩放动画曲线"}),HotPointAnim.attributes.add("alphaCurve",{type:"curve",title:"透明动画曲线"}),HotPointAnim.prototype.initialize=function(){this.time=Math.random()*this.duration},HotPointAnim.prototype.update=function(t){this.time+=t,this.time%=this.duration;var i=this.scaleCurve.value(this.time/this.duration);this.entity.setLocalScale(i,i,i),this.entity.element.opacity=this.alphaCurve.value(this.time/this.duration)};var PosController=pc.createScript("posController");PosController.attributes.add("posID",{type:"number",min:0,default:0,title:"位置ID"}),PosController.prototype.initialize=function(){this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.button.on("click",this.onClick,this)},PosController.prototype.onEnter=function(t){document.body.style.cursor="pointer"},PosController.prototype.onLeave=function(t){document.body.style.cursor="default"},PosController.prototype.onClick=function(t,o,e){window.CAR_INNER_POS=this.posID};var CarOptionController=pc.createScript("carOptionController");CarOptionController.attributes.add("style1",{type:"entity",array:!0,title:"高配"}),CarOptionController.attributes.add("style2",{type:"entity",array:!0,title:"低配"}),CarOptionController.prototype.initialize=function(){this.modelID=-1},CarOptionController.prototype.update=function(t){if(window.CAR_ID!=this.modelID){for(this.modelID=window.CAR_ID,i=0;i<this.style1.length;i++)null!==this.style1[i]&&(this.style1[i].enabled=0===this.modelID);for(i=0;i<this.style2.length;i++)null!==this.style2[i]&&(this.style2[i].enabled=1===this.modelID)}};var CarInnerColorController=pc.createScript("carInsideColorController");CarInnerColorController.attributes.add("mixDuration",{type:"number",default:.3,title:"混合时间",description:"颜色切换时，渐变动画的持续时间。"}),CarInnerColorController.attributes.add("loading",{type:"asset",assetType:"texture",title:"遮罩贴图"}),CarInnerColorController.attributes.add("lazyLoad",{type:"boolean",title:"需要时加载",description:"勾选时，只在切换颜色时才开始加载选择的内饰贴图。不勾选时，进入场景后就马上开始加载所有贴图。"}),CarInnerColorController.attributes.add("texturesA",{type:"asset",assetType:"texture",array:!0,title:"前座贴图集"}),CarInnerColorController.attributes.add("texturesB",{type:"asset",assetType:"texture",array:!0,title:"后座贴图集"}),CarInnerColorController.prototype.initialize=function(){var e={attributes:{aPosition:pc.SEMANTIC_POSITION,aUv0:pc.SEMANTIC_TEXCOORD0},vshader:"attribute vec3 aPosition;\nattribute vec2 aUv0;\nuniform mat4 matrix_model;\nuniform mat4 matrix_viewProjection;\nvarying vec2 vUv0;\nvoid main(void)\n{\n    vUv0 = aUv0;\n    gl_Position = matrix_viewProjection * matrix_model * vec4(aPosition, 1.0);\n}",fshader:"precision "+this.app.graphicsDevice.precision+" float;\nvarying vec2 vUv0;\nuniform float uMixTime;\nuniform sampler2D uDiffuseMap1;\nuniform sampler2D uDiffuseMap2;\nvoid main(void)\n{\n    vec4 color1 = texture2D(uDiffuseMap1,vUv0);\n    vec4 color2 = texture2D(uDiffuseMap2,vUv0);\n    gl_FragColor = mix(color1,color2,clamp(uMixTime,0.0,1.0));\n}"};if(this.material=new pc.Material,this.material.setShader(new pc.Shader(this.app.graphicsDevice,e)),this.entity.model.model.meshInstances[0].material=this.material,this.time=0,this.mixBeginTime=-1e3,this.innerID=-1,this.posID=-1,this.material.setParameter("uDiffuseMap1",this.loading.resource),this.material.setParameter("uDiffuseMap2",this.loading.resource),!this.lazyLoad){var t=0;for(t=0;t<this.texturesA.length;t++)null!==this.texturesA[t]&&this.app.assets.load(this.texturesA[t]);for(t=0;t<this.texturesB.length;t++)null!==this.texturesB[t]&&this.app.assets.load(this.texturesB[t])}},CarInnerColorController.prototype.update=function(e){if(this.time+=e,2==window.UIMODE){var t=(this.time-this.mixBeginTime)/this.mixDuration;t<1?this.material.setParameter("uMixTime",t):(this.checkChange(),this.material.setParameter("uMixTime",(this.time-this.mixBeginTime)/this.mixDuration))}},CarInnerColorController.prototype.checkChange=function(){if(window.CAR_INNER_ID!=this.innerID||window.CAR_INNER_POS!=this.posID){this.innerID=window.CAR_INNER_ID,this.posID=window.CAR_INNER_POS;var e=0===this.posID?this.texturesA:this.texturesB,t=this.innerID;t=Math.max(0,t);var i=e[t=Math.min(t,e.length-1)];if(i.resource)this.mixBeginTime=this.time,this.back=this.fore,this.fore=i.resource,this.material.setParameter("uDiffuseMap1",this.back),this.material.setParameter("uDiffuseMap2",this.fore);else{this.mixBeginTime=this.time,this.back=this.fore,this.fore=this.loading.resource,this.material.setParameter("uDiffuseMap1",this.back),this.material.setParameter("uDiffuseMap2",this.fore);var r=this;i.once("load",function(){r.mixBeginTime=r.time,r.back=r.fore,r.fore=i.resource,r.material.setParameter("uDiffuseMap1",r.back),r.material.setParameter("uDiffuseMap2",r.fore)}),this.app.assets.load(i)}}};var CarViewToggleController=pc.createScript("carViewToggleController");CarViewToggleController.attributes.add("distance",{type:"number",title:"临界视距"}),CarViewToggleController.attributes.add("cameraEntity",{type:"entity",array:!1,title:"相机物体"}),CarViewToggleController.attributes.add("targetEntity",{type:"entity",array:!1,title:"目标物体"}),CarViewToggleController.attributes.add("outsideEntitys",{type:"entity",array:!0,title:"外部物体"}),CarViewToggleController.attributes.add("frontPoint",{type:"entity",title:"前座引导点"}),CarViewToggleController.attributes.add("backPoint",{type:"entity",title:"后座引导点"}),CarViewToggleController.attributes.add("insideEntitys",{type:"entity",array:!0,title:"内饰物体"}),CarViewToggleController.prototype.initialize=function(){},CarViewToggleController.prototype.update=function(t){for(var e=this.cameraEntity.getPosition().clone(),i=this.targetEntity.getPosition().clone(),r=e.sub(i).length()<this.distance,n=0;n<this.insideEntitys.length;n++)this.insideEntitys[n]&&(this.insideEntitys[n].enabled=r);for(var o=0;o<this.outsideEntitys.length;o++)this.outsideEntitys[o]&&(this.outsideEntitys[o].enabled=!r);this.backPoint&&(this.backPoint.enabled=r&&0===window.CAR_INNER_POS),this.backPoint&&(this.frontPoint.enabled=r&&1===window.CAR_INNER_POS)};var CarOutsideLazyLoadController=pc.createScript("carOutsideLazyLoadController");CarOutsideLazyLoadController.attributes.add("dealyTime",{type:"number",default:3,title:"车体内饰节点"}),CarOutsideLazyLoadController.attributes.add("lazyEnity",{type:"entity",title:"车体内饰节点"}),CarOutsideLazyLoadController.attributes.add("lazyModel",{type:"asset",assetType:"model",title:"车体内饰模型"}),CarOutsideLazyLoadController.attributes.add("fadeDuration",{type:"number",default:.5,title:"车窗透明的动画持续时间"}),CarOutsideLazyLoadController.attributes.add("relativeMaterial",{type:"asset",assetType:"material",title:"车窗材质"}),CarOutsideLazyLoadController.attributes.add("relativeEntity",{type:"entity",array:!0,title:"车体内饰相关实体"}),CarOutsideLazyLoadController.prototype.initialize=function(){this.time=0,this.beginTime=0,this.loaded=!1,this.delay=0,this.material=this.relativeMaterial.resource,this.material&&(this.opacity=this.material.opacity,this.material.opacity=1);for(var t=0;t<this.relativeEntity.length;t++)this.relativeEntity[t]&&(this.relativeEntity[t].enabled=!1);this.delay=this.dealyTime},CarOutsideLazyLoadController.prototype.update=function(t){if(this.time+=t,this.delay>0&&(this.delay-=t,this.delay<0))if(this.lazyModel.resource)this.beginTime=this.time,this.loaded=!0,this.lazyEnity.enabled=!0;else{var e=this;this.lazyModel.once("load",function(){e.beginTime=e.time,e.loaded=!0,e.lazyEnity.enabled=!0}),this.app.assets.load(this.lazyModel)}if(this.loaded){var i=this.time-this.beginTime;if(i<this.fadeDuration)this.material&&(this.material.opacity=1+i/this.fadeDuration*(this.opacity-1),this.material.update());else{this.material&&(this.material.opacity=this.opacity);for(var a=0;a<this.relativeEntity.length;a++)this.relativeEntity[a]&&(this.relativeEntity[a].enabled=!0);this.loaded=!1}}};var CarLightController=pc.createScript("carLightController");CarLightController.attributes.add("frontLights",{type:"entity",array:!0,title:"前大灯列表"}),CarLightController.attributes.add("warningLightTime1",{type:"number",min:.1,default:.5,title:"警告灯闪烁亮灯时长"}),CarLightController.attributes.add("warningLightTime2",{type:"number",min:.1,default:.5,title:"警告灯闪烁灭灯时长"}),CarLightController.attributes.add("warningLights",{type:"entity",array:!0,title:"警告灯列表"}),CarLightController.prototype.initialize=function(){this.carFrontLightOpen=!window.CAR_FRONT_LIGHT_OPEN,this.carWarningLightOpen=!window.CAR_WARNING_LIGHT_OPEN,this.carWarningLightOpenTime=-1,this.time=0},CarLightController.prototype.update=function(t){this.time+=t;var i=0,n=window.UIMODE<2;if(window.CAR_FRONT_LIGHT_OPEN!=this.carFrontLightOpen&&(this.carFrontLightOpen=window.CAR_FRONT_LIGHT_OPEN,null!==this.frontLights))for(i=0;i<this.frontLights.length;i++)this.frontLights[i]&&(this.frontLights[i].enabled=this.carFrontLightOpen&&n);if(window.CAR_WARNING_LIGHT_OPEN!=this.carWarningLightOpen){this.carWarningLightOpen=window.CAR_WARNING_LIGHT_OPEN,this.carWarningLightOpenTime=this.time;for(var r=0;r<this.warningLights.length;r++)this.warningLights[i]&&(this.warningLights[r].enabled=!1)}if(null!==this.warningLights&&this.carWarningLightOpen)for(var h=(this.time-this.carWarningLightOpenTime)%(this.warningLightTime1+this.warningLightTime2),e=0;e<this.warningLights.length;e++)this.warningLights[i]&&(this.warningLights[e].enabled=h<this.warningLightTime1&&n)};